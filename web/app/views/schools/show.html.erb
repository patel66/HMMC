<link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="http://github.hubspot.com/odometer/themes/odometer-theme-plaza.css" />
    <script src="http://github.hubspot.com/odometer/odometer.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<div class="container">
	<div class="row slideLeft bigEntrance">
		
		<div class="school-info-sidebar col-md-3 box">
			<div class="school-details row">
				<h1><%=@school.name %></h2>
				<h5><%=@school.city + ", "+@school.state %></h5>
			</div>			
			<div class="school-details row">
				<h3>National Rank: 3</h3>
				<h3>State Rank: 2</h3>
				<h3>City Rank: 1</h3>
				
			</div>			
			<div class="school-details row">
				<h2>Students Participating</h2>
				<h2><%=@school.students%></h2>
			</div>
			
		</div>
		<div class="school-stats-section col-md-6">
			<!-- <h1 id="miles">15,465 </h1> -->
			<div id="odometer" class="odometer" >63255</div>
			<!-- <h4 id="miles"> Miles Ran</h4> -->
    		<!-- <input></input>
	 	   <button></button> -->

      	<div id="donut" data-donut="30">
	    		
	    </div>
	      <div class="goal"><h3> Of Goal Met</h3>
		</div>
	    <div id="win"></div>

	    	<div>
	    	</div>
	    <!-- input id="goal"></input
	    <input id="miles"></input>
	    <button></button> -->
 
		</div>

		<div class="ranking col-md-3 box">
			<h1>Achievements</h1>
			<div class="achievements">	
				<%=image_tag('reach.png') %>
				<%=image_tag('1.png') %>
				<%=image_tag('Veteran.png') %>
				<%=image_tag('1k.png') %>
				<%=image_tag('5k.png') %>
				<%=image_tag('10k.png') %>
				<%=image_tag('20k.png') %>
				<%=image_tag('25k.png')%>
				<%=image_tag('50k.png') %>
			</div>

		</div>


	<div class="row">
		<div class="col-md-6 col-md-offset-3">

			<div class="user-actions ">
				<div class="action-icons">
					<i id="addMiles" class="fa fa-plus-square"></i>
					
					<i id="addStudents" class="fa fa-child"></i>
					
					<i id="history" class="fa fa-calendar"></i>
				</div>
			</div>

		</div>
	</div>	

	<div  class="addMiles" >
		<div class="row">
		  <div class="page-header"><h2>Add Miles</h2></div>
		  <form class="form-horizontal">
		    <fieldset>
		      <!-- Mile input-->
		      
		      <div class="row">
		      	<div class="col-md-6 col-md-offset-3">
			        <div class="col-md-6">
			        	<h3>Miles</h3>
			        </div> 
			        <div class="col-md-6">
			          <input id="mile" name="mile" type="number" placeholder="Enter Miles Ran" class="form-control input-lg">
			        </div>
		      	</div>
		      </div>

		      <div class="row">
		      	<div class="col-md-6 col-md-offset-3">
			        <div class="col-md-6">
			        	<h3>Students</h3>
			        </div> 
			        <div class="col-md-6">
			          <input id="studentsP" name="studentsP" type="number" placeholder="Students Participating" class="form-control input-lg">
			        </div>
		      	</div>
		      </div>		

		      <!-- Button (Double) -->
		      
		      <div class="form-group">
		        <label class="col-md-3 control-label" for="log"></label>
		      <div class="col-md-6">
		        <button id="log" name="log" class="btn btn-block btn-success">Log Activity</button>
		      </div>
		    </fieldset>
		  </form>
		</div> <!--./row -->
	</div> <!--./container -->

	<div  class="profile" >
		<div class="row">
		  <div class="page-header"><h2>School Profile</h2></div>
		  <form class="form-horizontal">
		    <fieldset>
		      <div class="page-header">
		      		<h3><%= @school.name %></h3>
				    <h3><%= @school.street %></h3>
				    <h3><%= @school.city + ", " + @school.state %></h3>
		      </div>
		      <!-- Mile input-->
		      <div class="row">
		      	<div class="col-md-6 col-md-offset-3">
			        <div class="col-md-6">
			        	<h3>Total Students</h3>
			        </div> 
			        <div class="col-md-6">
			          <input id="students" name="students" type="number" value="<%=@school.students %>" class="form-control input-lg">
			        </div>
		      	</div>	
		      </div>
			  <div class="row">
		      	<div class="col-md-6 col-md-offset-3">
			        <div class="col-md-6">
			        	<h3>Goal</h3>
			        </div> 
			        <div class="col-md-6">
			          <input id="schoolGoal" name="schoolGoal" type="number" value="<%=@school.goal%>" class="form-control input-lg">
			        </div>
		      	</div>	
		      </div> 
		      <div class="row">
		      	<div class="col-md-6 col-md-offset-3">
			        <div class="col-md-6">
			        	<h3>Coach</h3>
			        </div> 
			        <div class="col-md-6">
			          <input id="name" name="name" type="text" value="<%=@user.name %>" class="form-control input-lg">
			        </div>
		      	</div>	
		      </div>
		      <div class="row">
		      	<div class="col-md-6 col-md-offset-3">
			        <div class="col-md-6">
			        	<h3>Email</h3>
			        </div> 
			        <div class="col-md-6">
			          <input id="email" name="email" type="text" value="<%=@user.email %>" class="form-control input-lg">
			        </div>
		      	</div>	
		      </div>
  		
		      <!-- Button (Double) -->
		      <div class="form-group">
		        <label class="col-md-3 control-label" for="save"></label>
		      <div class="col-md-6">
		        <button id="save" name="save" class="btn btn-block btn-success">Save</button>
		      </div>
		    </fieldset>
		  </form>
		</div> <!--./row -->
	</div> <!--./container -->
<!--
  <div class="historylist">
    <h3>History of Activity:</h3>
    <ul style="list-style-type: none">
      <% @school.activitys.each do |activity| %>
      <li>
      <%="Miles ran: #{activity.miles} " %>

      <%="Students: #{activity.students} "%>
      <%="Date: #"%>
      </li>
      <%end%>
    </ul>
  </div> -->

<table class="historylist">
  <thead>
    <tr>
      <th>Miles</th>
      <th>Students</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody>

    <%@school.activitys.each do |activity| %>
      <tr>
        <td><%=activity.miles%></td>
          <td><%= activity.students%></td>
        <td><></td>
      </tr>
    <%end%>

    <% @school.activitys.each do |activity| %>
        <tr>
        </tr>
    <%end%>

    <% @school.activitys.each do |activity| %>
      <tr>
      </tr>
    <%end%>

  </tbody>
</table>


 <!-- Odometer Script -->
  <script>
    //     setTimeout(function(){
    //     odometer.innerHTML = 456;
    // }, 1000);
    // odometer.innerHTML = school total miles + num
    var y = $(window).scrollTop();  //your current y position on the page
    $("#addMiles").on("click", function(){
    	$(".addMiles").slideToggle();
    	$(".profile").hide();
    	$(".history").hide();
		$(window).scrollTop(y+150);
    }); 

    $("#addStudents").on("click", function(){
    	$(".profile").slideToggle();
    	$(".addMiles").hide();
    	$(".history").hide();
		$(window).scrollTop(y+150);
    });

     $("#history").on("click", function(){
    	$(".history").slideToggle();
    	$(".addMiles").hide();
    	$(".profile").hide();
		$(window).scrollTop(y+150);
    });

    $("button").on("click",function(){
      var num = +$("input").val();
      odometer.innerHTML = num;
    });

  </script>

<!-- Graph script -->

      <script>
var duration   = 2000,
transition = 100;

var goal = 10000; // school's preset goal! // have input for this
var total = 2342; // school's total miles // from backend!!

  var num = total/goal * 100
  drawDonutChart(
  '#donut',
  num,
  260,
  260,
  ".45em"
  );

$("button").on("click",function(e){
  e.preventDefault();	
  var msglist = document.getElementById("donut");
  var x = +$("input").val();

  console.log(x)
  msglist.setAttribute("data-donut","");
  total+= x
  console.log(total)

  var show = msglist.getAttribute("data-donut");
  console.log(num)
  // per = ((total+parseInt(x))/goal)*100

  msglist.setAttribute("data-donut", num ) ;

   $("#donut").empty();

   var num = total/goal * 100
   if (num >= 100) {
    $("#win").text("YOU GUYS DID IT!!!!!")
   }
  drawDonutChart(
  '#donut',
  num,
  260,
  260,
  ".45em"
  );

});


function drawDonutChart(element, percent, width, height, text_y) {
  width = typeof width !== 'undefined' ? width : 200;
  height = typeof height !== 'undefined' ? height : 200;
  text_y = typeof text_y !== 'undefined' ? text_y : "-.10em";

  var dataset = {
        lower: calcPercent(0),
        upper: calcPercent(percent)
      },
      radius = Math.min(width, height) / 2,
      pie = d3.layout.pie().sort(null),
      format = d3.format(".0%");

  var arc = d3.svg.arc()
        .innerRadius(radius - 20)
        .outerRadius(radius);

  var svg = d3.select(element).append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

  var path = svg.selectAll("path")
        .data(pie(dataset.lower))
        .enter().append("path")
        .attr("class", function(d, i) { return "color" + i })
        .attr("d", arc)
        .each(function(d) { this._current = d; }); // store the initial values

  var text = svg.append("text")
        .attr("text-anchor", "middle")
        .attr("dy", text_y);

  if (typeof(percent) === "string") {
    text.text(percent);
    console.log(percent)

  }
  else {
    var progress = 0;
    var timeout = setTimeout(function () {
      clearTimeout(timeout);
      path = path.data(pie(dataset.upper)); // update the data
      path.transition().duration(duration).attrTween("d", function (a) {
        // Store the displayed angles in _current.
        // Then, interpolate from _current to the new angles.
        // During the transition, _current is updated in-place by d3.interpolate.
        var i  = d3.interpolate(this._current, a);
        var i2 = d3.interpolate(progress, percent)
        this._current = i(0);
        return function(t) {
          text.text( format(i2(t) / 100) );
          return arc(i(t));
        };
      }); // redraw the arcs
    }, 200);
  }
};

function calcPercent(percent) {
  return [percent, 100-percent];
};
</script>
